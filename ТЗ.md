Зрозуміло. Я додав це важливе уточнення щодо формату ІД звернення у відповідний розділ.

Ось фінальна версія документа з урахуванням цього доповнення.

---

### **Технічне завдання на створення звернень НДСЛ «Охматдит»**
**Фінальна версія для розробки (v.3.2)**

---

### **Розділ 1. Загальні положення**

#### **1.1. Завдання функціоналу:**
1.  Створення, перегляд та моніторинг життєвого циклу звернень.
2.  Розподіл доступу та обов'язків між різними ролями користувачів.
3.  Автоматичне інформування відповідальних осіб про ключові події.
4.  Надання інструментів для моніторингу ефективності обробки звернень.

#### **1.2. Рівні доступів (Ролі):**
1.  **Оператор:**
    *   Створення нових звернень.
    *   Перегляд лише тих звернень, які були створені ним особисто.
2.  **Виконавець:**
    *   Перегляд звернень у категоріях, до яких він має доступ.
    *   Можливість взяти звернення в роботу (змінити статус з «Нове» на «В роботі»).
    *   Зміна статусів довірених йому звернень.
    *   Додавання публічних та внутрішніх коментарів.
3.  **Адміністратор:**
    *   Повний доступ до всіх звернень, незалежно від статусу чи категорії.
    *   Усі права Виконавця та Оператора.
    *   Створення, редагування, блокування та скидання паролів для всіх користувачів.
    *   Управління системними довідниками («Категорії», «Канали звернення»).
    *   Ручне перепризначення відповідального Виконавця у будь-якому зверненні.
    *   Доступ до панелі моніторингу (Дашборду).

#### **1.3. Статуси звернень:**
1.  **Нове:** Призначається автоматично при створенні.
2.  **В роботі:** Виконавець бере звернення на опрацювання.
3.  **Потребує уточнення:** Повертається на доопрацювання.
4.  **Відхилено:** Кінцевий статус, якщо звернення не може бути виконане.
5.  **Завершено:** Кінцевий статус, що означає успішне виконання.

***Примітка:*** *Після переходу звернення у кінцевий статус («Завершено» або «Відхилено»), редагування основних полів блокується. Додавати коментарі дозволяється.*

---

### **Розділ 2. Робота зі зверненнями**

#### **2.1. Створення звернення (Форма)**
Створення звернень доступне лише для ролі «Оператор».
*   **Категорія:** Вибір зі списку (довідник), обов'язкове.
*   **Підкатегорія:** Текстове поле, необов'язкове.
*   **Канал звернення:** Вибір зі списку (довідник), обов'язкове.
*   **Ім'я:** Текстове поле, обов'язкове (допускається значення "Відмова назвати").
*   **Суть звернення:** Текстове поле, обов'язкове.
*   **Телефон / E-mail:** Необов'язкові поля.
*   **Файл:** Поле для завантаження додатків.
    *   **Вимоги до файлів:**
        *   Максимальний розмір одного файлу: **10 МБ**.
        *   Дозволені формати: **.pdf, .doc, .docx, .xls, .xlsx, .jpg, .jpeg, .png**.
        *   Дозволяється завантаження **декількох файлів** одночасно.

#### **2.2. Список звернень та фільтрація**
*   **Сортування:** За замовчуванням список відсортований від найновіших до найстаріших звернень.
*   **Логіка фільтрації:** При заповненні декількох полів фільтра, результати повинні відповідати всім критеріям одночасно (логіка "І" / AND).

#### **2.3. Картка звернення**
*   **ІД (ID):** **Унікальний 6-значний номер звернення**, що генерується системою автоматично при створенні. Є основним ідентифікатором звернення в системі та сповіщеннях.
*   **Відповідальний:** ПІБ Виконавця, який першим змінив статус на «В роботі». Адміністратор має право змінити відповідального вручну.
*   **Коментарі:**
    *   Поруч з полем для введення коментаря повинен бути чекбокс **«Внутрішній коментар»**.
    *   **Публічні коментарі** видимі для Оператора, Відповідального Виконавця та Адміністратора.
    *   **Внутрішні коментарі** видимі лише для Виконавців (тієї ж категорії) та Адміністраторів.

---

### **Розділ 3. Панель моніторингу (Дашборд)**

Доступний лише для користувачів з рівнем доступу «Адміністратор».
*   **Основні віджети:** Статистика за період, звернення за статусами, список протермінованих звернень, ефективність Виконавців.

---

### **Розділ 4. Управління користувачами та довідниками**

Цей функціонал доступний лише для ролі «Адміністратор».

#### **4.1. Створення нового користувача:**
*   **Логін\*, ПІБ\*, Email\*, Пароль\*, Рівень доступу\***.
*   **Вимоги до паролю:** мінімум 8 символів, повинен містити літери та цифри.
*   При виборі ролі «Виконавець» з'являється обов'язкове поле «Категорії».

#### **4.2. Управління існуючими користувачами:**
Адміністратор має можливість:
*   **Редагувати:** Змінювати ПІБ, Email, роль, набір категорій.
    *   ***Примітка:*** *Логін змінювати не можна.*
*   **Деактивувати/Заблокувати:** Тимчасово блокувати доступ користувача.
    *   ***Правило безпеки:*** *При спробі деактивації Виконавця, система повинна перевіряти наявність у нього активних звернень (у статусі «В роботі» або «Потребує уточнення»). Якщо такі звернення є, деактивація блокується з вимогою попередньо перепризначити їх іншому Виконавцю.*
*   **Скинути пароль:** Генерувати новий тимчасовий пароль.

#### **4.3. Управління довідниками:**
Адміністратор має доступ до розділу, де він може керувати списками: «Категорії звернень» та «Канали звернень».
*   ***Правило цілісності даних:*** *Система повинна блокувати видалення значень з довідників, якщо ці значення використовуються хоча б в одному існуючому зверненні. Для виведення застарілих значень з ужитку слід передбачити функцію «Деактивувати» або «Архівувати».*

---

### **Розділ 5. Інформування та Ескалація**

#### **5.1. Стандартні сповіщення (Email):**
*   **Про нове звернення:** Отримують усі Виконавці, за якими закріплена відповідна категорія.
*   **Про новий коментар:** Отримують Відповідальний Виконавець та Оператор (якщо коментар публічний).
*   **Про зміну статусу:** Отримують Відповідальний Виконавець та Оператор.

#### **5.2. Сповіщення про перепризначення звернення:**
*   **Тригер:** Ручна зміна поля «Відповідальний» Адміністратором.
*   **Отримувачі та зміст:**
    *   **Попередній Виконавець** отримує лист: *"Звернення [ІД звернення] було знято з вашого опрацювання."*
    *   **Новий Виконавець** отримує лист: *"Вам було призначено звернення [ІД звернення] для опрацювання."*

#### **5.3. Ескалація:**
*   Якщо звернення у статусі «Нове» не взято в роботу протягом **3 календарних днів**, система надсилає сповіщення-нагадування усім Виконавцям відповідної категорії та всім Адміністраторам.
*   Такі звернення у загальному списку візуально виділяються (наприклад, блідо-червоним фоном рядка).