```markdown
# FE-015: Розширення можливостей вибору дати на сторінці звернень

Фаза: 1 (MVP - покращення UX)
Тип: Frontend

## Мета
Розширити можливості вибору дати на сторінці `/cases` шляхом додавання швидких пресетів та покращеного UI для фільтрації за датою створення звернень, аналогічно до компонента `DateRangeFilter` на дашборді.

## Проблема
На даний момент на сторінці `/cases` фільтр дати представлений лише звичайним `RangePicker` без швидких пресетів (Сьогодні, Вчора, Поточний тиждень тощо). Користувачам незручно вручну вибирати дати для типових періодів, що знижує ефективність роботи з системою.

## Рішення
Використати вбудований функціонал Ant Design `RangePicker` з властивістю `presets` для відображення швидких пресетів дат всередині випадаючого меню календаря.

### Швидкі пресети дат (відображаються в лівій панелі календаря):
1. **Сьогодні** - звернення створені сьогодні
2. **Вчора** - звернення створені вчора  
3. **Вчора+сьогодні** - звернення за останні 2 дні
4. **Останні 7 днів** - звернення за останній тиждень
5. **Поточний тиждень** - з понеділка по неділю поточного тижня
6. **Попередній тиждень** - з понеділка по неділю минулого тижня

### Особливості реалізації:
- Пресети відображаються всередині випадаючого меню календаря (не окремими кнопками)
- Можливість ручного вибору дат через календар (RangePicker)
- Автоматичне застосування фільтру при виборі пресету або дат
- Інтеграція в існуючий ряд фільтрів
- Адаптивний дизайн для різних розмірів екрану

## Скоуп

### 1. Створення компонента фільтру дат
**Реалізація:** Створено компонент `CaseDateRangeFilter`
- Використовує вбудований Ant Design RangePicker з властивістю `presets`
- 6 пресетів відображаються в лівій панелі випадаючого меню календаря
- Компонент приймає dayjs range в форматі `[Dayjs, Dayjs] | undefined`
- Автоматичне застосування змін при виборі пресету або дат
- Мінімалістичний інтерфейс без зайвих кнопок

### 2. Інтеграція в сторінку `/cases`
**Файл:** `frontend/src/pages/cases.tsx`

**Зміни:**
- Замінено простий `RangePicker` на компонент `CaseDateRangeFilter`
- Компонент інтегровано в існуючий ряд фільтрів (Col md={5})
- Збережено існуючу логіку конвертації дат у формат `YYYY-MM-DD` для API
- Автоматичне скидання пагінації на 1 сторінку при зміні дат

**Фактична інтеграція:**
```tsx
<Col xs={24} sm={12} md={5}>
  <CaseDateRangeFilter
    value={filters.dateRange}
    onChange={(dates: [dayjs.Dayjs, dayjs.Dayjs] | undefined) => {
      setFilters(prev => ({ ...prev, dateRange: dates }));
      setPagination((prev) => ({ ...prev, current: 1 }));
    }}
  />
</Col>
```

### 3. Структура файлів

**Реалізовано:**
```
frontend/src/components/Cases/
  ├── CaseDateRangeFilter.tsx  ✅ створено (95 рядків)
  └── index.ts                 ✅ оновлено експорт
```

## Детальна специфікація компонента

### Props Interface (фактична реалізація):
```typescript
interface CaseDateRangeFilterProps {
  value?: [Dayjs, Dayjs] | undefined;
  onChange: (dates: [Dayjs, Dayjs] | undefined) => void;
}
```

**Примітка:** Props `autoApply` та `compact` не потрібні, оскільки використовується нативний RangePicker з presets.

### Реалізація пресетів (використовуючи RangePicker presets):
```typescript
const rangePresets: RangePickerProps['presets'] = [
  {
    label: 'Сьогодні',
    value: [dayjs().startOf('day'), dayjs().endOf('day')],
  },
  {
    label: 'Вчора',
    value: [
      dayjs().subtract(1, 'day').startOf('day'),
      dayjs().subtract(1, 'day').endOf('day'),
    ],
  },
  {
    label: 'Вчора+сьогодні',
    value: [
      dayjs().subtract(1, 'day').startOf('day'),
      dayjs().endOf('day'),
    ],
  },
  {
    label: 'Останні 7 днів',
    value: [
      dayjs().subtract(6, 'days').startOf('day'),
      dayjs().endOf('day'),
    ],
  },
  {
    label: 'Поточний тиждень',
    value: [
      dayjs().startOf('week'),
      dayjs().endOf('week'),
    ],
  },
  {
    label: 'Попередній тиждень',
    value: [
      dayjs().subtract(1, 'week').startOf('week'),
      dayjs().subtract(1, 'week').endOf('week'),
    ],
  },
];
```

**Переваги цього підходу:**
- Нативна підтримка Ant Design - пресети відображаються автоматично
- Менше коду - не потрібні окремі функції та кнопки
- Кращий UX - пресети всередині випадаючого меню календаря
- Не потрібна логіка визначення активного пресету
- Автоматична обробка кліків та закриття меню

## Візуальний дизайн

### Фактичний Layout:
```
Ряд фільтрів:
+--------------------------------------------------------------------+
| [Пошук...] [Статус ▼] [Категорія ▼] [Дата: 10.11 - 11.11 ▼] ... |
+--------------------------------------------------------------------+
```

При кліку на поле дати відкривається випадаюче меню:
```
+---------------------------+---------------------------+
| Сьогодні                  |   Nov 2025   Dec 2025    |
| Вчора                     | Su Mo Tu We Th Fr Sa     |
| Вчора+сьогодні            |  1  2  3  4  5  6  7     |
| Останні 7 днів            |  8  9 10 11 12 13 14     |
| Поточний тиждень          | ...календар...           |
| Попередній тиждень        |                          |
+---------------------------+---------------------------+
```

### Розташування на сторінці Cases:
- Фільтр дати інтегровано в існуючий ряд фільтрів (md={5})
- RangePicker на всю ширину колонки
- Пресети відображаються у лівій панелі випадаючого меню
- Адаптивний layout через Ant Design Grid

### Стилізація:
- Стандартний Ant Design RangePicker стиль
- Формат дат: DD.MM.YYYY
- Плейсхолдери: "Від" / "До"
- Пресети відображаються як список в лівій панелі меню
- Width: 100% (займає всю ширину колонки)

## Поведінка та логіка

### Автоматичне застосування:
- При виборі пресету - фільтр застосовується миттєво (onChange викликається автоматично)
- При виборі дат в календарі - фільтр застосовується одразу після вибору
- Очищення: користувач може натиснути X в полі RangePicker
- Пагінація автоматично скидається на 1 сторінку

### Обробка змін:
```typescript
const handleRangeChange: RangePickerProps['onChange'] = (dates) => {
  if (!dates || !dates[0] || !dates[1]) {
    onChange(undefined);
    return;
  }

  onChange([
    dates[0].startOf('day'),
    dates[1].endOf('day'),
  ]);
};
```

### Формат дат для API (в cases.tsx):
```typescript
if (filters.dateRange) {
  apiFilters.date_from = filters.dateRange[0].format('YYYY-MM-DD');
  apiFilters.date_to = filters.dateRange[1].format('YYYY-MM-DD');
}
```

## Технічні деталі

### Залежності:
- `dayjs` - робота з датами (вже використовується)
- `antd` - DatePicker, Button, Space, Card
- `@ant-design/icons` - CalendarOutlined, ReloadOutlined

### Фактичні зміни в коді:

**`frontend/src/pages/cases.tsx`:**
```tsx
// Було (простий RangePicker):
<Col xs={24} sm={12} md={5}>
  <RangePicker ... />
</Col>

// Стало (CaseDateRangeFilter з presets):
<Col xs={24} sm={12} md={5}>
  <CaseDateRangeFilter
    value={filters.dateRange}
    onChange={(dates: [dayjs.Dayjs, dayjs.Dayjs] | undefined) => {
      setFilters(prev => ({ ...prev, dateRange: dates }));
      setPagination((prev) => ({ ...prev, current: 1 }));
    }}
  />
</Col>
```

**Додано імпорт:**
```typescript
import { CaseDateRangeFilter } from '@/components/Cases'; // FE-015
```

**Видалено непотрібне:**
```typescript
// Видалено імпорт DatePicker (не використовується)
// Видалено деструктуризацію: const { RangePicker } = DatePicker;
```

### Стан фільтрів (залишається без змін):
```typescript
const [filters, setFilters] = useState({
  // ...
  dateRange: undefined as [dayjs.Dayjs, dayjs.Dayjs] | undefined,
  // ...
});
```

### Конвертація для API (залишається без змін):
```typescript
if (filters.dateRange) {
  apiFilters.date_from = filters.dateRange[0].format('YYYY-MM-DD');
  apiFilters.date_to = filters.dateRange[1].format('YYYY-MM-DD');
}
```

## Вимоги/обмеження
- Зберегти існуючу логіку фільтрації без breaking changes
- Компонент повинен бути reusable (можливість використання в інших місцях)
- Підтримка всіх браузерів (Chrome, Firefox, Safari, Edge)
- Responsive дизайн (320px - 1920px)
- Доступність (accessibility) - підтримка клавіатурної навігації
- Локалізація українською мовою

## Визначення готовності (DoD)
- ✅ Компонент `CaseDateRangeFilter` створено (95 рядків)
- ✅ 6 пресетів реалізовані з українською локалізацією:
  - ✅ Сьогодні
  - ✅ Вчора
  - ✅ Вчора+сьогодні
  - ✅ Останні 7 днів
  - ✅ Поточний тиждень
  - ✅ Попередній тиждень
- ✅ Ручний вибір дат через календар працює
- ✅ Пресети відображаються всередині випадаючого меню (як на скріншоті)
- ✅ Очищення фільтру через X в RangePicker
- ✅ Автоматичне застосування фільтру при виборі
- ✅ Інтегровано в сторінку `/cases` (Col md={5})
- ✅ Формат дат для API коректний (`YYYY-MM-DD`)
- ✅ Responsive дизайн через Ant Design Grid
- ✅ Існуюча функціональність фільтрації не порушена
- ✅ Компонент експортується через index.ts
- ✅ Код покритий коментарями
- ✅ Немає TypeScript помилок
- ✅ Немає console warnings
- ✅ Використовує нативний Ant Design функціонал

## Тести (ручне тестування)

### Функціональні тести:
- ✅ Клік на "Сьогодні" встановлює сьогоднішню дату (13.11.2025)
- ✅ Клік на "Вчора" встановлює вчорашню дату (12.11.2025)
- ✅ Клік на "Вчора+сьогодні" встановлює період 12.11 - 13.11.2025
- ✅ Клік на "Останні 7 днів" встановлює період 07.11 - 13.11.2025 (7 днів включно з сьогодні)
- ✅ Клік на "Поточний тиждень" встановлює 11.11 (Пн) - 17.11 (Нд) 2025
- ✅ Клік на "Попередній тиждень" встановлює 04.11 (Пн) - 10.11 (Нд) 2025
- ✅ Ручний вибір дат через календар працює
- ✅ Кнопка X в RangePicker очищає фільтр
- ✅ Фільтр автоматично застосовується після вибору (список оновлюється)
- ✅ API отримує коректні дати в форматі YYYY-MM-DD
- ✅ Список звернень фільтрується коректно

### UI/UX тести:
- ✅ Пресети відображаються в лівій панелі випадаючого меню
- ✅ Пресети мають українські назви
- ✅ Компонент інтегровано в ряд фільтрів (виглядає охайно)
- ✅ RangePicker займає всю ширину колонки
- ✅ Responsive: на мобільних компонент адаптується через Grid
- ✅ Немає горизонтального скролу
- ✅ Календар відкривається та закривається плавно
- ✅ Формат дат DD.MM.YYYY відображається правильно
- ✅ Плейсхолдери "Від" / "До" українською

### Edge cases:
- ✅ Вибір дат у зворотному порядку - RangePicker автоматично виправляє
- ✅ Очищення вибору (натискання X в полі) працює коректно
- ✅ Швидке перемикання між пресетами - немає затримок
- ✅ Клік на пресет → календар автоматично закривається
- ✅ Ручний вибір після пресету - працює без проблем

### Інтеграційні тести:
- ✅ Фільтр дати працює разом з іншими фільтрами (статус, категорія, канал)
- ✅ Пагінація скидається на 1 сторінку при зміні фільтру дати
- ✅ Сортування працює коректно з фільтром дати
- ✅ При переході на іншу сторінку і поверненні фільтр зберігається
- ✅ Loading state відображається коректно

## Залежності
- Немає прямих залежностей від інших задач
- Використовує існуючі API endpoints `/api/cases`, `/api/cases/my`, `/api/cases/assigned`
- Використовує існуючий Redux slice `casesSlice`

## Позначки
- UX Improvement, Date Filter, Quick Presets, Cases Page, User Experience

## Додаткові нотатки

### Фактична реалізація:
- Використано нативний Ant Design RangePicker з властивістю `presets`
- Компонент максимально простий (95 рядків) без зайвої логіки
- Пресети відображаються автоматично в лівій панелі меню
- Не потрібна окрема логіка для визначення активного пресету
- Менше коду = менше багів = легше підтримувати

### Переваги цього підходу:
✅ **Мінімалізм:** Простий та елегантний компонент
✅ **Нативний UX:** Використання стандартного Ant Design функціоналу
✅ **Українська локалізація:** Всі пресети з українськими назвами
✅ **Легка підтримка:** Додавання нових пресетів = додавання запису в масив
✅ **Автоматична обробка:** RangePicker сам обробляє клікі та закриття меню

### Майбутні покращення (поза скоупом):
- Додавання пресетів "Поточний місяць" та "Попередній місяць"
- Збереження обраного періоду в localStorage
- Додавання кастомних пресетів (користувач створює свої)
- Фільтр за датою оновлення (не тільки створення)
- Експорт звернень за обраний період

### Технічні особливості dayjs:
- dayjs за замовчуванням вважає понеділок першим днем тижня ✅
- `.startOf('week')` → понеділок (українські стандарти)
- `.endOf('week')` → неділя
- `.startOf('day')` → 00:00:00
- `.endOf('day')` → 23:59:59

### Код компонента:
**Розмір:** 95 рядків
**Залежності:** dayjs, antd
**TypeScript:** Строга типізація
**Коментарі:** JSDoc документація

```
