# üöÄ –†–û–ó–ì–û–†–¢–ê–ù–ù–Ø –ù–ê PRODUCTION –°–ï–†–í–ï–†–Ü crm.ohmatdyt.com.ua

## ‚úÖ –°—Ç–∞—Ç—É—Å –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏: –ì–û–¢–û–í–û

–í—Å—ñ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ —Ñ–∞–π–ª–∏ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ –¥–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –Ω–∞ production —Å–µ—Ä–≤–µ—Ä—ñ.

---

## üìÅ –°—Ç–≤–æ—Ä–µ–Ω—ñ —Ñ–∞–π–ª–∏:

### –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è:
- ‚úÖ `ohmatdyt-crm\.env.prod` - Production environment –∑–º—ñ–Ω–Ω—ñ

### –°–∫—Ä–∏–ø—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:
- ‚úÖ `deploy-crm-ohmatdyt.ps1` - –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π deployment –∑ Windows
- ‚úÖ `ohmatdyt-crm\deploy-crm-ohmatdyt.sh` - Deployment —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ `deploy-menu.bat` - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é –¥–ª—è Windows

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:
- ‚úÖ `DEPLOYMENT_SUMMARY.md` - –ö–æ—Ä–æ—Ç–∫–∏–π –æ–ø–∏—Å –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏
- ‚úÖ `DEPLOYMENT_CRM_OHMATDYT_COM_UA.md` - –î–µ—Ç–∞–ª—å–Ω–∞ –ø–æ–∫—Ä–æ–∫–æ–≤–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è
- ‚úÖ `QUICKSTART_CRM_OHMATDYT.md` - –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç (3 –≤–∞—Ä—ñ–∞–Ω—Ç–∏)
- ‚úÖ `DEPLOYMENT_CHECKLIST.txt` - –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ –∑ 11 —Ñ–∞–∑
- ‚úÖ `README_DEPLOYMENT.md` - –¶–µ–π —Ñ–∞–π–ª

---

## üéØ –Ø–ö –ü–û–ß–ê–¢–ò –†–û–ó–ì–û–†–¢–ê–ù–ù–Ø?

### üî• –ù–∞–π—à–≤–∏–¥—à–∏–π —Å–ø–æ—Å—ñ–±:

```batch
REM –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –º–µ–Ω—é
deploy-menu.bat
```

–ê–±–æ –Ω–∞–ø—Ä—è–º—É:

```powershell
REM –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è –∑ Windows
.\deploy-crm-ohmatdyt.ps1
```

### üìñ –í–∞—Ä—ñ–∞–Ω—Ç–∏ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:

#### –í–∞—Ä—ñ–∞–Ω—Ç 1: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑ Windows (5 —Ö–≤–∏–ª–∏–Ω)
```powershell
cd f:\ohmatdyt_crm
.\deploy-crm-ohmatdyt.ps1
```

**–©–æ —Ä–æ–±–∏—Ç—å:**
- –ü—ñ–¥–∫–ª—é—á–∞—î—Ç—å—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
- –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
- –°—Ç–≤–æ—Ä—é—î volumes
- –ó–±–∏—Ä–∞—î –æ–±—Ä–∞–∑–∏
- –ó–∞–ø—É—Å–∫–∞—î —Å–µ—Ä–≤—ñ—Å–∏
- –í–∏–∫–æ–Ω—É—î –º—ñ–≥—Ä–∞—Ü—ñ—ó
- –°—Ç–≤–æ—Ä—é—î –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

#### –í–∞—Ä—ñ–∞–Ω—Ç 2: –í—Ä—É—á–Ω—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ (10 —Ö–≤–∏–ª–∏–Ω)
```bash
# 1. –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è
ssh root@crm.ohmatdyt.com.ua

# 2. –ü–µ—Ä–µ–π—Ç–∏ –≤ –ø—Ä–æ–µ–∫—Ç
cd ~/ohmatdyt-crm

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–∫—Ä–∏–ø—Ç
chmod +x deploy-crm-ohmatdyt.sh
./deploy-crm-ohmatdyt.sh
```

#### –í–∞—Ä—ñ–∞–Ω—Ç 3: –ü–æ–∫—Ä–æ–∫–æ–≤–æ (15-20 —Ö–≤–∏–ª–∏–Ω)
–î–∏–≤—ñ—Ç—å—Å—è –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—é –≤ `DEPLOYMENT_CRM_OHMATDYT_COM_UA.md`

---

## ‚ö†Ô∏è –í–ê–ñ–õ–ò–í–û –ø–µ—Ä–µ–¥ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º!

### –û–Ω–æ–≤–∏—Ç–∏ –≤ `.env.prod`:

1. **Database Password** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):
   ```env
   POSTGRES_PASSWORD=–í–∞—à–°–∫–ª–∞–¥–Ω–∏–π–ü–∞—Ä–æ–ª—å123!
   DATABASE_URL=postgresql+psycopg://ohm_user:–í–∞—à–°–∫–ª–∞–¥–Ω–∏–π–ü–∞—Ä–æ–ª—å123!@db:5432/ohm_db
   ```

2. **JWT Secret** (—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ):
   ```bash
   # –ó–≥–µ–Ω–µ—Ä—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π:
   openssl rand -hex 32
   # –ê–±–æ:
   python -c "import secrets; print(secrets.token_hex(32))"
   ```

3. **SMTP Password** (—è–∫—â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ email):
   ```env
   SMTP_PASSWORD=–í–∞—àGmailAppPassword
   ```

---

## üåê –©–æ –±—É–¥–µ –ø—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:

**URLs:**
- Frontend: `https://crm.ohmatdyt.com.ua`
- API: `https://crm.ohmatdyt.com.ua/api/`
- API Docs: `https://crm.ohmatdyt.com.ua/api/docs`
- Health: `https://crm.ohmatdyt.com.ua/health`

**–¢–∏–º—á–∞—Å–æ–≤—ñ –æ–±–ª—ñ–∫–æ–≤—ñ –¥–∞–Ω—ñ:**
- Email: `admin@ohmatdyt.com`
- Password: `admin123`
- ‚ö†Ô∏è **–ó–º—ñ–Ω—ñ—Ç—å –æ–¥—Ä–∞–∑—É –ø—ñ—Å–ª—è –≤—Ö–æ–¥—É!**

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è:

| –§–∞–π–ª | –û–ø–∏—Å | –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ |
|------|------|---------------------|
| `QUICKSTART_CRM_OHMATDYT.md` | –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç | –•–æ—á—É —à–≤–∏–¥–∫–æ –ø–æ—á–∞—Ç–∏ |
| `DEPLOYMENT_CRM_OHMATDYT_COM_UA.md` | –ü–æ–≤–Ω–∞ —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è | –ü–æ—Ç—Ä—ñ–±–Ω—ñ –¥–µ—Ç–∞–ª—ñ |
| `DEPLOYMENT_CHECKLIST.txt` | –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ | –°–ª—ñ–¥–∫—É–≤–∞—Ç–∏ –∑–∞ –ø—Ä–æ–≥—Ä–µ—Å–æ–º |
| `DEPLOYMENT_SUMMARY.md` | –†–µ–∑—é–º–µ –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ | –©–æ –≤–∂–µ –∑—Ä–æ–±–ª–µ–Ω–æ |

---

## üõ†Ô∏è –ö–æ—Ä–∏—Å–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:

### –ù–∞ —Å–µ—Ä–≤–µ—Ä—ñ:

```bash
# –°—Ç–∞—Ç—É—Å
docker compose ps

# –õ–æ–≥–∏
docker compose logs -f
docker compose logs -f api
docker compose logs -f nginx

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose restart api
docker compose restart nginx

# –û–Ω–æ–≤–ª–µ–Ω–Ω—è
cd ~/ohmatdyt-crm
git pull origin main
docker compose -f docker-compose.yml -f docker-compose.prod.yml build
docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
docker compose exec api alembic upgrade head

# Backup –±–∞–∑–∏ –¥–∞–Ω–∏—Ö
docker compose exec db pg_dump -U ohm_user ohm_db > backup_$(date +%Y%m%d).sql
```

### –ó Windows:

```powershell
# –ü—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
ssh root@crm.ohmatdyt.com.ua

# –°–∫–æ–ø—ñ—é–≤–∞—Ç–∏ —Ñ–∞–π–ª –Ω–∞ —Å–µ—Ä–≤–µ—Ä
scp file.txt root@crm.ohmatdyt.com.ua:~/

# –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –ª–æ–≥–∏
ssh root@crm.ohmatdyt.com.ua "cd ~/ohmatdyt-crm && docker compose logs -f"
```

---

## üêõ Troubleshooting:

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –º–æ–∂—É –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –¥–æ —Å–µ—Ä–≤–µ—Ä–∞
```powershell
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è
ping crm.ohmatdyt.com.ua
ssh -v root@crm.ohmatdyt.com.ua
```

### –ü—Ä–æ–±–ª–µ–º–∞: Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ –∑–∞–ø—É—Å–∫–∞—î—Ç—å—Å—è
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏
docker compose logs [service_name]

# –ü–µ—Ä–µ–∑—ñ–±—Ä–∞—Ç–∏
docker compose build --no-cache [service_name]

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏
docker compose restart [service_name]
```

### –ü—Ä–æ–±–ª–µ–º–∞: SSL –Ω–µ –ø—Ä–∞—Ü—é—î
```bash
# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ DNS
nslookup crm.ohmatdyt.com.ua

# –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ø–æ—Ä—Ç–∏
sudo netstat -tulpn | grep -E ':(80|443)'

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ Let's Encrypt
cd ~/ohmatdyt-crm/nginx
bash setup-letsencrypt.sh
```

### –ë—ñ–ª—å—à–µ troubleshooting:
–î–∏–≤—ñ—Ç—å—Å—è —Ä–æ–∑–¥—ñ–ª "Troubleshooting" –≤ `DEPLOYMENT_CRM_OHMATDYT_COM_UA.md`

---

## ‚úÖ Checklist —à–≤–∏–¥–∫–æ—ó –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏:

–ü–µ—Ä–µ–¥ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è–º:
- [ ] Docker –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ
- [ ] –ü—Ä–æ–µ–∫—Ç –∫–ª–æ–Ω–æ–≤–∞–Ω–æ –∑ GitHub
- [ ] DNS –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ (crm.ohmatdyt.com.ua ‚Üí IP —Å–µ—Ä–≤–µ—Ä–∞)
- [ ] –ü–æ—Ä—Ç–∏ 80 —ñ 443 –≤—ñ–¥–∫—Ä–∏—Ç—ñ
- [ ] `.env.prod` —Å—Ç–≤–æ—Ä–µ–Ω–æ
- [ ] –ü–∞—Ä–æ–ª—ñ –æ–Ω–æ–≤–ª–µ–Ω–æ –≤ `.env.prod`

–ü—ñ—Å–ª—è —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è:
- [ ] –í—Å—ñ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏ –∑–∞–ø—É—â–µ–Ω—ñ (`docker compose ps`)
- [ ] Frontend –¥–æ—Å—Ç—É–ø–Ω–∏–π (https://crm.ohmatdyt.com.ua)
- [ ] API –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î (https://crm.ohmatdyt.com.ua/api/healthz)
- [ ] SSL –ø—Ä–∞—Ü—é—î (–∑–∞–º–æ–∫ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ)
- [ ] –ú–æ–∂–Ω–∞ —É–≤—ñ–π—Ç–∏ (admin@ohmatdyt.com / admin123)
- [ ] –ü–∞—Ä–æ–ª—å –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∑–º—ñ–Ω–µ–Ω–æ

---

## üöÄ –ì–û–¢–û–í–û –î–û –†–û–ó–ì–û–†–¢–ê–ù–ù–Ø!

**–ó–∞–ø—É—Å—Ç–∏—Ç–∏ –∑–∞—Ä–∞–∑:**

```batch
deploy-menu.bat
```

–∞–±–æ

```powershell
.\deploy-crm-ohmatdyt.ps1
```

---

**–£—Å–ø—ñ—à–Ω–æ–≥–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞–Ω–Ω—è! üéâ**

*–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è - –¥–∏–≤—ñ—Ç—å—Å—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—é –∞–±–æ –ø–∏—à—ñ—Ç—å –≤ –ø—ñ–¥—Ç—Ä–∏–º–∫—É.*
